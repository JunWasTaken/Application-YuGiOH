package p1Code;

import java.util.ArrayList;
import java.util.Scanner;

import exception.InvalidNameException;
import exception.InvalidValueHasard;
import exception.InvalidValuePV;
import exception.InvalidChoiceException;

public class Match2J {
	public Scanner sc = new Scanner(System.in);
	private ArrayList<Joueur> ListeJoueur = new ArrayList<Joueur>();
	public int NbJoueur;
	
	public Match2J() throws Exception {
		this.DeroulementPartie();
	}
	
	public void initialisationNbJoueur() { //initialise le nombre de Joueurs
		System.out.println("Combien de Joueur vont Participer ? 2 ou 4 ?");
		NbJoueur = sc.nextInt();
	}
	
	public void initialisationJoueur() throws InvalidNameException { //Initialise un joueur et l'ajoute à la liste des joueurs
		for (int i=0; i<NbJoueur; i++) {
			Joueur a = new Joueur();
			a.createJoueur();
		}
	}

	public void GestionHasard() throws InvalidValueHasard { //Gère le choix du joueur au cas où une gestion du hasard serait nécessaire
		Hasard h = new Hasard();
		int choix;
		
		System.out.println("Que voulez-vous faire ?\n 1-Lancer de pièce\n 2-lancer de dé");
		choix=sc.nextInt();
		if (choix!=1 && choix !=2)
			throw new InvalidValueHasard();
		else {
			if (choix==1) {
				System.out.println("La piece a ete lancee, vous avez fait "+h.CoinFlip());
			}else{
				System.out.println("Le de a roule et c'est arrete sur un "+h.LancerDe());
			}
		}
	}

	public void GestionPV2J() throws InvalidValuePV { //Gère les PVs dans un match à 2 Joueurs
		String choixJoueur;
		int pv;
		System.out.println("Veuillez saisir le pseudo du Joueur concerne (Vous pouvez egalement entrer son numero de joueur)");
		choixJoueur = sc.next();
		if (choixJoueur.contains(ListeJoueur.get(0).GetPseudo()) || choixJoueur.contains("Joueur 1") || choixJoueur.contains("1") || choixJoueur.contains("J1")) {
			System.out.print("De combien voulez-vous modifier les PV du Joueur ? ");
			pv = sc.nextInt();
			System.out.print("\n");
			ListeJoueur.get(1).ModifPV(pv);
		}else if (choixJoueur.contains(ListeJoueur.get(1).GetPseudo()) || choixJoueur.contains("Joueur 2") || choixJoueur.contains("2") || choixJoueur.contains("J2")) {
			System.out.print("De combien voulez-vous modifier les PV du Joueur ? ");
			pv = sc.nextInt();
			System.out.print("\n");
			ListeJoueur.get(2).ModifPV(pv);
		}else
			throw new InvalidValuePV();
	}

	public void MessageFinPartie2J() { //Affiche un message personnalisé en fonction du joueur qui a gagné 
		if (ListeJoueur.get(0).GetPV()==0)
			System.out.println(ListeJoueur.get(0).GetPseudo()+" a perdu");
		else
			System.out.println(ListeJoueur.get(1).GetPseudo()+" a perdu");
	}

	public void DeroulementPartie() throws Exception { //Gère le déroulement d'une partie à 2 Joueurs
		int choix;
		this.initialisationNbJoueur();
		this.initialisationJoueur();
		do {
			String NicknameJ1 = ListeJoueur.get(0).GetPseudo();
			String NicknameJ2 = ListeJoueur.get(1).GetPseudo();
			int PVJ1 = ListeJoueur.get(0).GetPV();
			int PVJ2 = ListeJoueur.get(1).GetPV();
			System.out.print("-----------------------\nPV "+NicknameJ1+" : "+PVJ1+"\nPV "+NicknameJ2+" : "+PVJ2+"\n-----------------------\n");
			System.out.println("Que voulez-vous faire ?\n1-Gerer les PV\n2-Partie Hasard");
			choix = sc.nextInt();
			if (choix==1)
				this.GestionPV2J();
			else if (choix==2)
				this.GestionHasard();
			else 
				throw new InvalidChoiceException();
		}while(ListeJoueur.get(0).GetPV()!=0 && ListeJoueur.get(0).GetPV()!=0);
		this.MessageFinPartie2J();
	}
}